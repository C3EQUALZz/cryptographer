#!/bin/bash
# Git pre-commit hook for Kotlin/Android project
# This hook runs code quality checks before commit

set -e

echo "ğŸ” Running pre-commit checks..."

# Format code automatically
echo "ğŸ“ Formatting code with Spotless..."
./gradlew spotlessApply

# Check if there are uncommitted changes after formatting
if ! git diff --quiet; then
    echo "âš ï¸  Spotless made formatting changes. Please review and stage them:"
    git diff --stat
    echo ""
    echo "Run 'git add .' to stage the formatted changes, then commit again."
    exit 1
fi

# Run static analysis
echo "ğŸ” Running Detekt static analysis..."
./gradlew detekt

echo "âœ… All pre-commit checks passed!"

