<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:147.0) Gecko/20100101 Firefox/147.0" version="29.3.2">
  <diagram name="AES Key Generation Detailed" id="aes-key-gen-flow-detailed">
    <mxGraphModel dx="1964" dy="1181" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="start" parent="1" style="ellipse;whiteSpace=wrap;html=1;fontStyle=1" value="начало" vertex="1">
          <mxGeometry height="50" width="120" x="640" y="70" as="geometry" />
        </mxCell>
        <mxCell id="check-support" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="Проверка того, что алгоритм поддерживается&amp;nbsp;" vertex="1">
          <mxGeometry height="75" width="230" x="585" y="165" as="geometry" />
        </mxCell>
        <mxCell id="error-unsupported" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Бросок исключения:&lt;br&gt;UnsupportedAlgorithmError(algorithm,&lt;br&gt;&quot;AesEncryptionService&quot;)&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="220" x="870" y="165" as="geometry" />
        </mxCell>
        <mxCell id="check-algo-type" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Проверка типа алгоритма:&lt;br&gt;when (algorithm)&lt;/div&gt;" vertex="1">
          <mxGeometry height="100" width="320" x="540" y="330" as="geometry" />
        </mxCell>
        <mxCell id="aes-128-case" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Случай: AES_128&lt;br&gt;&lt;br&gt;keySize = AES_128_KEY_SIZE_BYTES&lt;br&gt;keySize = 16 байт&lt;br&gt;&lt;br&gt;Ключ: 128 бит&lt;/div&gt;" vertex="1">
          <mxGeometry height="140" width="280" x="120" y="520" as="geometry" />
        </mxCell>
        <mxCell id="aes-192-case" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Случай: AES_192&lt;br&gt;&lt;br&gt;keySize = AES_192_KEY_SIZE_BYTES&lt;br&gt;keySize = 24 байта&lt;br&gt;&lt;br&gt;Ключ: 192 бит&lt;/div&gt;" vertex="1">
          <mxGeometry height="140" width="280" x="560" y="520" as="geometry" />
        </mxCell>
        <mxCell id="aes-256-case" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Случай: AES_256&lt;br&gt;&lt;br&gt;keySize = AES_256_KEY_SIZE_BYTES&lt;br&gt;keySize = 32 байта&lt;br&gt;&lt;br&gt;Ключ: 256 бит&lt;/div&gt;" vertex="1">
          <mxGeometry height="140" width="280" x="1000" y="520" as="geometry" />
        </mxCell>
        <mxCell id="return-key-size" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Возврат размера ключа - keySize&lt;/div&gt;" vertex="1">
          <mxGeometry height="60" width="320" x="560" y="700" as="geometry" />
        </mxCell>
        <mxCell id="create-array" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;keyBytes = ByteArray(keySize)&lt;/div&gt;&lt;div align=&quot;center&quot;&gt;SecureRandom().nextBytes(keyBytes)&lt;br&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="260" x="590" y="800" as="geometry" />
        </mxCell>
        <mxCell id="create-entity" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;EncryptionKey(&lt;br&gt;  value = keyBytes,&lt;br&gt;  algorithm = algorithm&lt;br&gt;)&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="220" x="610" y="910" as="geometry" />
        </mxCell>
        <mxCell id="return-success" parent="1" style="parallelogram;whiteSpace=wrap;html=1;fontStyle=1;align=center;" value="&lt;div align=&quot;center&quot;&gt;Возврат результата -&amp;nbsp;&lt;br&gt;Result.success(EncryptionKey)&lt;/div&gt;" vertex="1">
          <mxGeometry height="80" width="240" x="600" y="1030" as="geometry" />
        </mxCell>
        <mxCell id="end" parent="1" style="ellipse;whiteSpace=wrap;html=1;fontStyle=1" value="конец" vertex="1">
          <mxGeometry height="80" width="200" x="620" y="1140" as="geometry" />
        </mxCell>

        <mxCell id="e1" edge="1" parent="1" source="start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="check-support">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="check-support" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;exitDx=0;exitDy=0;entryDx=0;entryDy=0;" target="error-unsupported">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e2-label" connectable="0" parent="e2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.337" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="error-unsupported" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=1;exitDx=0;exitDy=0;entryDx=0;entryDy=0;" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="980" y="1200" />
              <mxPoint x="720" y="1200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e4" edge="1" parent="1" source="check-support" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryDx=0;entryDy=0;" target="check-algo-type" value="Да">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="check-algo-type" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="aes-128-case" value="AES_128">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" source="check-algo-type" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="aes-192-case" value="AES_192">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="check-algo-type" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="aes-256-case" value="AES_256">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e8" edge="1" parent="1" source="aes-128-case" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="return-key-size">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="200" y="700" />
              <mxPoint x="200" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e9" edge="1" parent="1" source="aes-192-case" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="return-key-size">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e10" edge="1" parent="1" source="aes-256-case" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;" target="return-key-size">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1180" y="700" />
              <mxPoint x="1180" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e11" edge="1" parent="1" source="return-key-size" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="create-array">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e12" edge="1" parent="1" source="create-array" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="create-entity">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e13" edge="1" parent="1" source="create-entity" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="return-success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e14" edge="1" parent="1" source="return-success" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" target="end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>


