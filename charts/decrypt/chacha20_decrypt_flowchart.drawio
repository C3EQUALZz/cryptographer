<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:147.0) Gecko/20100101 Firefox/147.0" version="29.3.2">
  <diagram name="ChaCha20 Decrypt Flow" id="chacha20-decrypt-flow">
    <mxGraphModel dx="202700" dy="143504" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-1" edge="1" parent="1" source="start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="check-algo">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="start" parent="1" style="ellipse;whiteSpace=wrap;html=1;fontStyle=1" value="начало" vertex="1">
          <mxGeometry height="50" width="120" x="640" y="40" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-2" edge="1" parent="1" source="check-algo" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" target="error-unsupported">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-10" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-2" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Нет" vertex="1">
          <mxGeometry relative="1" x="0.0345" y="2" as="geometry">
            <mxPoint x="-1" y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-5" edge="1" parent="1" source="check-algo" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="check-nonce">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-11" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-5" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Да" vertex="1">
          <mxGeometry relative="1" x="-0.36" y="3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="check-algo" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="Проверка алгоритма (CHACHA20_256)" vertex="1">
          <mxGeometry height="80" width="260" x="570" y="140" as="geometry" />
        </mxCell>
        <mxCell id="error-unsupported" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="&lt;div&gt;UnsupportedAlgorithmError(&lt;/div&gt;&lt;div&gt;&quot;ChaCha20EncryptionService&quot;&lt;/div&gt;&lt;div&gt;)&lt;/div&gt;" vertex="1">
          <mxGeometry height="70" width="250" x="1000" y="160" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-3" edge="1" parent="1" source="check-nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="error-nonce">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-12" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-3" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.1429" y="-1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-6" edge="1" parent="1" source="check-nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="check-length">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-13" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-6" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Да" vertex="1">
          <mxGeometry relative="1" x="-0.4667" y="-3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="check-nonce" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="Nonce присутствует и длина 12 байт" vertex="1">
          <mxGeometry height="70" width="260" x="570" y="270" as="geometry" />
        </mxCell>
        <mxCell id="error-nonce" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="DomainError (nonce отсутствует или неверная длина)" vertex="1">
          <mxGeometry height="70" width="300" x="1000" y="270" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-4" edge="1" parent="1" source="check-length" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="error-length">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-14" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-4" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.1733" y="2" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-7" edge="1" parent="1" source="check-length" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="split">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="kEUfvL7Wv9e8HPhVfpTe-15" connectable="0" parent="kEUfvL7Wv9e8HPhVfpTe-7" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Да" vertex="1">
          <mxGeometry relative="1" x="-0.1862" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="check-length" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="EncryptedData ≥ 16 байт (длина тега)?" vertex="1">
          <mxGeometry height="70" width="250" x="575" y="370" as="geometry" />
        </mxCell>
        <mxCell id="error-length" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="DomainError (данные слишком короткие)" vertex="1">
          <mxGeometry height="70" width="260" x="1000" y="370" as="geometry" />
        </mxCell>
        <mxCell id="split-detail-edge" edge="1" parent="1" source="split" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="split-calc-size">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="split" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="Разделение encryptedData" vertex="1">
          <mxGeometry height="50" width="240" x="590" y="480" as="geometry" />
        </mxCell>
        <mxCell id="split-calc-size" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="ciphertextSize = encryptedData.size - 16&#xa;(16 = TAG_LENGTH)" vertex="1">
          <mxGeometry height="60" width="280" x="40" y="590" as="geometry" />
        </mxCell>
        <mxCell id="split-copy-cipher" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="ciphertext = ByteArray(ciphertextSize)&#xa;System.arraycopy(encryptedData, 0, ciphertext, 0, ciphertextSize)" vertex="1">
          <mxGeometry height="60" width="360" y="680" as="geometry" />
        </mxCell>
        <mxCell id="split-copy-tag" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="tagBytes = ByteArray(16)&#xa;System.arraycopy(encryptedData, ciphertextSize, tagBytes, 0, 16)" vertex="1">
          <mxGeometry height="60" width="380" x="-10" y="770" as="geometry" />
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-1" edge="1" parent="1" source="create-tag-obj" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="poly-key-gen-decrypt">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="390" y="885" />
              <mxPoint x="390" y="590" />
              <mxPoint x="590" y="590" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="create-tag-obj" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="tag = Poly1305Tag.create(tagBytes)" vertex="1">
          <mxGeometry height="50" width="260" x="50" y="860" as="geometry" />
        </mxCell>
        <mxCell id="poly-key-gen-decrypt" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="Генерация Poly1305 ключа:&#xa;polyKey = ChaCha20.block(key, counter=0, nonce)[0..31]" vertex="1">
          <mxGeometry height="70" width="340" x="420" y="610" as="geometry" />
        </mxCell>
        <mxCell id="mac-data-prep" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="Подготовка macData:&#xa;macData = AAD || ciphertext || len(AAD) || len(ciphertext)&#xa;(AAD пустой в нашем случае)" vertex="1">
          <mxGeometry height="80" width="360" x="830" y="605" as="geometry" />
        </mxCell>
        <mxCell id="compute-expected-tag" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="Вычисление ожидаемого тега:&#xa;expectedTag = Poly1305.generateTag(macData, polyKey)" vertex="1">
          <mxGeometry height="70" width="340" x="840" y="740" as="geometry" />
        </mxCell>
        <mxCell id="constant-time-compare" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="Constant-time сравнение:&#xa;result = 0&#xa;for i: result |= (tag[i] XOR expectedTag[i])" vertex="1">
          <mxGeometry height="80" width="300" x="440" y="700" as="geometry" />
        </mxCell>
        <mxCell id="check-tag" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="result == 0?&#xa;(Тег валиден?)" vertex="1">
          <mxGeometry height="70" width="200" x="490" y="1020" as="geometry" />
        </mxCell>
        <mxCell id="error-auth" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="return null&#xa;DomainError(&quot;Authentication failed:&#xa;invalid tag. Data may be tampered.&quot;)" vertex="1">
          <mxGeometry height="80" width="280" x="960" y="940" as="geometry" />
        </mxCell>
        <mxCell id="chacha20-decrypt-init" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="ChaCha20 Stream Cipher Decrypt:&#xa;counter = 1, offset = 0" vertex="1">
          <mxGeometry height="60" width="260" x="460" y="1140" as="geometry" />
        </mxCell>
        <mxCell id="chacha20-decrypt-loop-start" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="offset &lt; ciphertext.size?" vertex="1">
          <mxGeometry height="70" width="200" x="490" y="1240" as="geometry" />
        </mxCell>
        <mxCell id="chacha20-decrypt-block" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="keyStream = ChaCha20.block(key, counter, nonce)&#xa;(64 байта)" vertex="1">
          <mxGeometry height="60" width="280" x="450" y="1350" as="geometry" />
        </mxCell>
        <mxCell id="chacha20-decrypt-xor" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="plaintext[offset..offset+blockLen] =&#xa;ciphertext[offset..offset+blockLen] XOR keyStream" vertex="1">
          <mxGeometry height="60" width="320" x="430" y="1440" as="geometry" />
        </mxCell>
        <mxCell id="chacha20-decrypt-inc" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="counter++&#xa;offset += blockLen" vertex="1">
          <mxGeometry height="50" width="140" x="520" y="1530" as="geometry" />
        </mxCell>
        <mxCell id="return-plaintext" parent="1" style="rounded=1;whiteSpace=wrap;html=1;align=center;" value="plaintext готов" vertex="1">
          <mxGeometry height="50" width="180" x="790" y="1260" as="geometry" />
        </mxCell>
        <mxCell id="return-success" parent="1" style="parallelogram;whiteSpace=wrap;html=1;fontStyle=1;align=center;" value="Result.success(plaintext)" vertex="1">
          <mxGeometry height="70" width="240" x="760" y="1370" as="geometry" />
        </mxCell>
        <mxCell id="end" parent="1" style="ellipse;whiteSpace=wrap;html=1;fontStyle=1" value="конец" vertex="1">
          <mxGeometry height="80" width="200" x="780" y="1480" as="geometry" />
        </mxCell>
        <mxCell id="split-to-calc" edge="1" parent="1" source="split" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;" target="split-calc-size">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="calc-to-copy-cipher" edge="1" parent="1" source="split-calc-size" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="split-copy-cipher">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="copy-cipher-to-tag" edge="1" parent="1" source="split-copy-cipher" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="split-copy-tag">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="copy-tag-to-obj" edge="1" parent="1" source="split-copy-tag" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="create-tag-obj">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="poly-to-mac" edge="1" parent="1" source="poly-key-gen-decrypt" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="mac-data-prep">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mac-to-expected" edge="1" parent="1" source="mac-data-prep" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="compute-expected-tag">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="expected-to-compare" edge="1" parent="1" source="compute-expected-tag" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="constant-time-compare">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="compare-to-check" edge="1" parent="1" source="constant-time-compare" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="4PjP7yFBaWUzNE9GICMY-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="check-tag-no" edge="1" parent="1" source="check-tag" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;" target="error-auth" value="Нет">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="check-tag-yes" edge="1" parent="1" source="check-tag" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;" target="chacha20-decrypt-init" value="Да">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="decrypt-init-to-loop" edge="1" parent="1" source="chacha20-decrypt-init" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="chacha20-decrypt-loop-start">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="loop-yes" edge="1" parent="1" source="chacha20-decrypt-loop-start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;" target="chacha20-decrypt-block" value="Да">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="block-to-xor" edge="1" parent="1" source="chacha20-decrypt-block" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="chacha20-decrypt-xor">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xor-to-inc" edge="1" parent="1" source="chacha20-decrypt-xor" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="chacha20-decrypt-inc">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="inc-back-to-loop" edge="1" parent="1" source="chacha20-decrypt-inc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=0;entryY=0.5;" target="chacha20-decrypt-loop-start">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="420" y="1555" />
              <mxPoint x="420" y="1275" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="loop-no" edge="1" parent="1" source="chacha20-decrypt-loop-start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;" target="return-plaintext" value="Нет">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="plaintext-to-success" edge="1" parent="1" source="return-plaintext" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="return-success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="success-to-end" edge="1" parent="1" source="return-success" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="end">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="error-unsupported-to-end" edge="1" parent="1" source="error-unsupported" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1350" y="195" />
              <mxPoint x="1350" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="error-nonce-to-end" edge="1" parent="1" source="error-nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1350" y="305" />
              <mxPoint x="1350" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="error-length-to-end" edge="1" parent="1" source="error-length" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1350" y="405" />
              <mxPoint x="1350" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="error-auth-to-end" edge="1" parent="1" source="error-auth" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;" target="end">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="start" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeWidth=1;" target="check-algo" />
        <mxCell id="e2" edge="1" parent="1" source="check-algo" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="error-unsupported" />
        <mxCell id="e2-label" parent="e2" style="edgeLabel;html=1;align=center;verticalAlign=middle;" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.2" y="-1" as="geometry" />
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="check-algo" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="check-nonce" value="Да" />
        <mxCell id="e4" edge="1" parent="1" source="check-nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="error-nonce" />
        <mxCell id="e4-label" parent="e4" style="edgeLabel;html=1;align=center;verticalAlign=middle;" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.2" y="-1" as="geometry" />
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="check-nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" target="check-length" value="Да" />
        <mxCell id="e6" edge="1" parent="1" source="check-length" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="error-length" />
        <mxCell id="e6-label" parent="e6" style="edgeLabel;html=1;align=center;verticalAlign=middle;" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.2" y="-1" as="geometry" />
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-4" edge="1" parent="1" source="4PjP7yFBaWUzNE9GICMY-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="4PjP7yFBaWUzNE9GICMY-3">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="590" y="870" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-9" connectable="0" parent="4PjP7yFBaWUzNE9GICMY-4" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Да" vertex="1">
          <mxGeometry relative="1" x="-0.3" y="5" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-7" edge="1" parent="1" source="4PjP7yFBaWUzNE9GICMY-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="4PjP7yFBaWUzNE9GICMY-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="result |= (tag[i] XOR expectedTag[i])" vertex="1">
          <mxGeometry height="60" width="160" x="510" y="920" as="geometry" />
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-8" edge="1" parent="1" source="4PjP7yFBaWUzNE9GICMY-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="check-tag">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="710" y="845" />
              <mxPoint x="710" y="1000" />
              <mxPoint x="590" y="1000" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-11" connectable="0" parent="4PjP7yFBaWUzNE9GICMY-8" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" value="Нет" vertex="1">
          <mxGeometry relative="1" x="-0.4892" y="3" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="4PjP7yFBaWUzNE9GICMY-6" parent="1" style="rhombus;whiteSpace=wrap;html=1;align=center;" value="i &amp;lt; tag.size" vertex="1">
          <mxGeometry height="70" width="200" x="490" y="810" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
